---
import Hr from "./Hr.astro";
import Socials from "./Socials.astro";

const currentYear = new Date().getFullYear();

export interface Props {
  noMarginTop?: boolean;
}

const { noMarginTop = false } = Astro.props;
---

<footer class={`${noMarginTop ? "" : "mt-auto"}`}>
  <Hr noPadding />
  <div class="footer-wrapper">
    <Socials centered />
    <div class="copyright-wrapper">
      <a
        href="/posts/uncopyright"
        class="sm:hover:text-textColor px-4 py-2 sm:px-2 sm:py-0 sm:hover:underline"
        >Uncopyright</a
      >
      |
      <a
        href="/rss.xml"
        class="sm:hover:text-textColor px-4 py-2 sm:px-2 sm:py-0 sm:hover:underline"
        >RSS</a
      >
      |
      <a
        href="/contact"
        class="sm:hover:text-textColor px-4 py-2 sm:px-2 sm:py-0 sm:hover:underline"
        >Work With Me</a
      >
      |
      <a
        href="/portfolio"
        class="sm:hover:text-textColor px-4 py-2 sm:px-2 sm:py-0 sm:hover:underline"
        >Portfolio</a
      >
    </div>
  </div>
  <div class="fixed bottom-4 right-4">
    <button
      id="back-to-top"
      class="rounded-full bg-green-600 px-3 py-2 font-bold text-white opacity-30 shadow-lg"
    >
      <svg
        fill="none"
        viewBox="0 0 24 24"
        stroke-width="3"
        stroke="currentColor"
        class="size-6"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          d="M4.5 10.5 12 3m0 0 7.5 7.5M12 3v18"></path>
      </svg>
    </button>
  </div>
</footer>

<style>
  footer {
    @apply w-full;
  }
  .footer-wrapper {
    @apply flex flex-col items-center justify-between py-6 sm:flex-row-reverse sm:py-4;
  }
  .link-button {
    @apply my-1 p-2 hover:rotate-6;
  }
  .link-button svg {
    @apply scale-125;
  }
  .copyright-wrapper {
    @apply my-2 flex flex-col items-center whitespace-nowrap sm:flex-row;
  }
  .separator {
    @apply hidden sm:inline;
  }
  a:hover {
    @apply text-xl text-green-400;
  }

  #back-to-top:focus {
    animation: horizontal-shaking 0.01s infinite;
  }

  @keyframes horizontal-shaking {
    0% {
      transform: translateX(0);
      filter: blur(1px);
    }
    25% {
      transform: translateX(10px);
      filter: blur(2px);
    }
    50% {
      transform: translateX(-10px);
      filter: blur(3px);
    }
    75% {
      transform: translateX(10px);
      filter: blur(4px);
    }
    100% {
      transform: translateX(0);
      filter: blur(5px);
    }
  }
</style>

<script is:inline>
  /** Scrolls the document to the top when
   * the "Back to Top" button is clicked. */
  function backToTop() {
    document.querySelector("#back-to-top")?.addEventListener("click", () => {
      document.body.scrollTop = 0; // For Safari
      document.documentElement.scrollTop = 0; // For Chrome, Firefox, IE and Opera
    });
  }
  backToTop();
  document.addEventListener("astro:after-swap", backToTop);
</script>
